{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport axios from 'axios';\n\nconst searchForm = document.querySelector('.form');\nconst galleryContainer = document.querySelector('.gallery');\nconst loaderElement = document.querySelector('.loader');\nconst loadMoreBtn = document.querySelector('.load-more');\n\nlet searchParamsDefaults = {\n  key: '41751590-b6ce5e955eace60263a904c25',\n  image_type: 'photo',\n  orientation: 'horizontal',\n  safesearch: true,\n  page: 1,\n  per_page: 40,\n};\n\nfunction showLoaderAndHideGallery() {\n  loaderElement.style.display = 'block';\n  galleryContainer.style.display = 'none';\n  loadMoreBtn.style.display = 'none';\n}\n\nfunction hideLoaderAndShowGallery() {\n  loaderElement.style.display = 'none';\n  galleryContainer.style.display = 'flex';\n  loadMoreBtn.style.display = 'block';\n}\n\nfunction generateGalleryHTML(hits) {\n  return hits.reduce((html, hit) => {\n    const { largeImageURL, webformatURL, tags, likes, views, comments, downloads } = hit;\n    return (\n      html +\n      `<li class=\"gallery-item\">\n        <a href=${largeImageURL}> \n          <img class=\"gallery-img\" src=${webformatURL} alt=${tags} />\n        </a>\n        <div class=\"gallery-text-box\">\n          <p>Likes: <span class=\"text-value\">${likes}</span></p>\n          <p>views: <span class=\"text-value\">${views}</span></p>\n          <p>comments: <span class=\"text-value\">${comments}</span></p>\n          <p>downloads: <span class=\"text-value\">${downloads}</span></p>\n        </div>\n      </li>`\n    );\n  }, '');\n}\n\nfunction renderGallery(hits) {\n  const galleryHTML = generateGalleryHTML(hits);\n  galleryContainer.innerHTML += galleryHTML; \n}\n\nfunction initializeImageLightbox() {\n  let lightbox = new SimpleLightbox('.gallery a', {\n    nav: true,\n    captionDelay: 250,\n    captionsData: 'alt',\n    close: true,\n    enableKeyboard: true,\n    docClose: true,\n  });\n  lightbox.refresh();\n}\n\nfunction handleNoResults() {\n  galleryContainer.style.display = 'none';\n  loadMoreBtn.style.display = 'none';\n  iziToast.error({\n    position: 'topRight',\n    color: 'red',\n    message: 'Sorry, there are no images matching your search query. Please try again!',\n  });\n}\n\nfunction handleEndOfCollection() {\n  loadMoreBtn.style.display = 'none';\n  iziToast.info({\n    position: 'topRight',\n    message: \"We're sorry, but you've reached the end of search results.\",\n  });\n}\n\nasync function searchImages(params) {\n  showLoaderAndHideGallery();\n\n  try {\n    const response = await axios.get(`https://pixabay.com/api/?${params}`);\n    hideLoaderAndShowGallery();\n\n    if (!response.data.totalHits || response.data.totalHits === 0) {\n      handleNoResults();\n    } else {\n      renderGallery(response.data.hits);\n      initializeImageLightbox();\n      searchParamsDefaults.page++; \n    }\n\n    // Перевірка на кінець колекції\n    const totalHits = response.data.totalHits || 0;\n    const currentPage = searchParamsDefaults.page || 1;\n    const perPage = searchParamsDefaults.per_page || 20;\n    const remainingHits = totalHits - currentPage * perPage;\n\n    if (remainingHits <= 0) {\n      handleEndOfCollection();\n    }\n\n\n} catch (error) {\n  console.error(error);\n\n  if (axios.isAxiosError(error)) {\n    const { response, request } = error;\n\n    if (response) {\n      iziToast.error({\n        position: 'topRight',\n        color: 'red',\n        message: `Server responded with an error: ${response.statusText}`,\n      });\n    } else if (request) {\n      iziToast.error({\n        position: 'topRight',\n        color: 'red',\n        message: 'Network error. Please try again later.',\n      });\n    }\n  } else {\n    // Інші типи помилок (наприклад, якщо не є AxiosError)\n    iziToast.error({\n      position: 'topRight',\n      color: 'red',\n      message: 'An unexpected error occurred. Please try again later.',\n    });\n  }\n\n  hideLoaderAndShowGallery();\n  handleNoResults();\n}\n\n\n}\n\nsearchForm.addEventListener('submit', event => {\n  event.preventDefault();\n  searchParamsDefaults.q = event.target.elements.search.value.trim();\n  searchParamsDefaults.page = 1; // Скидаємо сторінку при новому пошуку\n  const searchParams = new URLSearchParams(searchParamsDefaults);\n  searchImages(searchParams);\n  event.currentTarget.reset();\n});\n\nloadMoreBtn.addEventListener('click', event => {\n  event.preventDefault();\n  const searchParams = new URLSearchParams(searchParamsDefaults);\n  searchImages(searchParams);\n});\n"],"names":["searchForm","galleryContainer","loaderElement","loadMoreBtn","searchParamsDefaults","showLoaderAndHideGallery","hideLoaderAndShowGallery","generateGalleryHTML","hits","html","hit","largeImageURL","webformatURL","tags","likes","views","comments","downloads","renderGallery","galleryHTML","initializeImageLightbox","SimpleLightbox","handleNoResults","iziToast","handleEndOfCollection","searchImages","params","response","axios","totalHits","currentPage","perPage","error","request","event","searchParams"],"mappings":"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"}